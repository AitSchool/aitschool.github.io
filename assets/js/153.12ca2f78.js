(window.webpackJsonp=window.webpackJsonp||[]).push([[153],{1314:function(a,t,e){"use strict";e.r(t);var s=[function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"_6-4-微信支付"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-微信支付","aria-hidden":"true"}},[a._v("#")]),a._v(" 6.4 微信支付")]),s("p",[s("img",{attrs:{src:e(253),alt:"file"}})]),s("p",[a._v("上一节我们已经实现了支付宝支付，这一节我们要实现微信支付。")]),s("blockquote",[s("p",[a._v("微信支付的开发需要有一个微信公众号并且开通了微信支付才能正常进行，申请微信支付需要有公司资质。对于手上没有支付商户号的同学，可以大概地看下，知悉整个操作流程，心里有个概念，等以后在工作中遇到此类需求时，也可以胸有成竹。")])]),s("p",[a._v("首先访问微信支付商户平台 https://pay.weixin.qq.com/ 。")]),s("h2",{attrs:{id:"_1-获取商户号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取商户号","aria-hidden":"true"}},[a._v("#")]),a._v(" 1. 获取商户号")]),s("p",[a._v("登录之后点击顶部导航的 "),s("code",[a._v("产品中心")]),a._v("，再点击 "),s("code",[a._v("扫码支付")]),a._v("：")]),s("p",[s("img",{attrs:{src:e(252),alt:"file"}})]),s("p",[a._v("如果没有开通请先开通，开通之后点击页面上的 "),s("code",[a._v("产品设置")]),a._v(" 按钮：")]),s("p",[s("img",{attrs:{src:e(251),alt:"file"}})]),s("p",[a._v("页面上会显示 "),s("code",[a._v("商户号")]),a._v("，把这个商户号记下来，之后会用到。")]),s("p",[s("img",{attrs:{src:e(250),alt:"file"}})]),s("h2",{attrs:{id:"_2-下载-api-证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载-api-证书","aria-hidden":"true"}},[a._v("#")]),a._v(" 2 下载 API 证书")]),s("p",[a._v("接下来通过顶部导航切换到 "),s("code",[a._v("账户中心")]),a._v("，点击左侧菜单 "),s("code",[a._v("API 安全")]),a._v("，点击 "),s("code",[a._v("下载证书")]),a._v(" 按钮：")]),s("p",[s("img",{attrs:{src:e(249),alt:"file"}})]),s("p",[a._v("再点击 "),s("code",[a._v("下载")]),a._v(" 按钮：")]),s("p",[s("img",{attrs:{src:e(248),alt:"file"}})]),s("p",[a._v("会弹出提示要短信验证码和密码，输入之后证书就会被下载下来，应该有如下几个文件：")]),s("p",[s("img",{attrs:{src:e(247),alt:"file"}})]),s("p",[a._v("我们只需要后面两个 "),s("code",[a._v(".pem")]),a._v(" 后缀的文件。")]),s("p",[a._v("接下来把这两个文件放入项目中，在项目中新建文件夹 "),s("code",[a._v("resources/wechat_pay")]),a._v("：")]),s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ mkdir -p resources/wechat_pay\n")])]),s("p",[a._v("然后将这两个文件复制到这个目录下。")]),s("h2",{attrs:{id:"_3-设置密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-设置密钥","aria-hidden":"true"}},[a._v("#")]),a._v(" 3. 设置密钥")]),s("p",[a._v("接着回到刚刚微信商户平台的页面，页面往下拉，会看到一个 "),s("code",[a._v("设置密钥")]),a._v(" 按钮：")]),s("p",[s("img",{attrs:{src:e(246),alt:"file"}})]),s("blockquote",[s("p",[a._v("!!! 注意：如果这是一个已经在使用的支付号，一般是已经设置过密钥了，这里就不需要再次设置，修改密钥可能会影响已有的线上交易。")])]),s("p",[s("img",{attrs:{src:e(245),alt:"file"}})]),s("p",[a._v("密钥可以通过 http://www.unit-conversion.info/texttools/random-string-generator/ 这个网站来生成：")]),s("p",[s("img",{attrs:{src:e(244),alt:"file"}})]),s("p",[s("code",[a._v("Length")]),a._v(" 那个框填入 "),s("code",[a._v("32")]),a._v(" 然后点击 "),s("code",[a._v("Generate")]),a._v(" 按钮，下方的 "),s("code",[a._v("Output")]),a._v(" 就会出现一个 32 个字符的随机字符串，把这个字符串复制下来。")]),s("p",[a._v("接下来把这些配置参数写到我们的配置文件里")]),s("p",[s("em",[a._v("config/pay.php")])]),s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    'wechat' => [\n        'app_id'      => 'wx*******',   // 公众号 app id\n        'mch_id'      => '14*****',  // 第一步获取到的商户号\n        'key'         => '******', // 刚刚设置的 API 密钥\n        'cert_client' => resource_path('wechat_pay/apiclient_cert.pem'),\n        'cert_key'    => resource_path('wechat_pay/apiclient_key.pem'),\n        'log'         => [\n            'file' => storage_path('logs/wechat_pay.log'),\n        ],\n    ],\n")])]),s("h2",{attrs:{id:"git-代码版本控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git-代码版本控制","aria-hidden":"true"}},[a._v("#")]),a._v(" Git 代码版本控制")]),s("p",[a._v("接着让我们将这些文件加入到版本控制中：")]),s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('$ git add -A\n$ git commit -m "集成微信支付"\n')])])])}],r=e(0),p=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},s,!1,null,null,null);t.default=p.exports},244:function(a,t,e){a.exports=e.p+"assets/img/6.4_10.22a3c4cb.png"},245:function(a,t,e){a.exports=e.p+"assets/img/6.4_9.47b67096.png"},246:function(a,t,e){a.exports=e.p+"assets/img/6.4_8.b1ef4fee.png"},247:function(a,t){a.exports="data:image/png;base64,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"},248:function(a,t,e){a.exports=e.p+"assets/img/6.4_6.78ef4243.png"},249:function(a,t,e){a.exports=e.p+"assets/img/6.4_5.095d0b67.png"},250:function(a,t,e){a.exports=e.p+"assets/img/6.4_4.5681874a.png"},251:function(a,t,e){a.exports=e.p+"assets/img/6.4_3.9e340c56.png"},252:function(a,t,e){a.exports=e.p+"assets/img/6.4_2.faaf5b6d.png"},253:function(a,t,e){a.exports=e.p+"assets/img/6.4_1.5f95c0d3.png"}}]);