(window.webpackJsonp=window.webpackJsonp||[]).push([[330],{1432:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"_3-3-生成骨架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-生成骨架","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.3 生成骨架")]),n("h2",{attrs:{id:"说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#说明","aria-hidden":"true"}},[t._v("#")]),t._v(" 说明")]),n("p",[t._v("天下武功，唯快不破，Laravel 最吸引人的地方，就是其开发上的高效。这一节我们来利用起上一章节安装的代码生成器，快速构建我们的帖子原型。")]),n("h2",{attrs:{id:"整理字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整理字段","aria-hidden":"true"}},[t._v("#")]),t._v(" 整理字段")]),n("p",[t._v("在使用代码生成器之前，我们需要先整理好 "),n("code",[t._v("topics")]),t._v(" 表的字段名称和字段类型：")]),n("table",[n("thead",[n("tr",[n("th",[t._v("字段名称")]),n("th",[t._v("描述")]),n("th",[t._v("字段类型")]),n("th",[t._v("加索引缘由")]),n("th",[t._v("其他")])])]),n("tbody",[n("tr",[n("td",[n("code",[t._v("title")])]),n("td",[t._v("帖子标题")]),n("td",[t._v("字符串（String）")]),n("td",[t._v("文章搜索")]),n("td",[t._v("无")])]),n("tr",[n("td",[n("code",[t._v("body")])]),n("td",[t._v("帖子内容")]),n("td",[t._v("文本（text）")]),n("td",[t._v("不需要")]),n("td",[t._v("无")])]),n("tr",[n("td",[n("code",[t._v("user_id")])]),n("td",[t._v("用户 ID")]),n("td",[t._v("整数（int）")]),n("td",[t._v("数据关联")]),n("td",[n("code",[t._v("unsigned()")])])]),n("tr",[n("td",[n("code",[t._v("category_id")])]),n("td",[t._v("分类 ID")]),n("td",[t._v("整数（int）")]),n("td",[t._v("数据关联")]),n("td",[n("code",[t._v("unsigned()")])])]),n("tr",[n("td",[n("code",[t._v("reply_count")])]),n("td",[t._v("回复数量")]),n("td",[t._v("整数（int）")]),n("td",[t._v("文章回复数量排序")]),n("td",[n("code",[t._v("unsigned()")]),t._v(", "),n("code",[t._v("default(0)")])])]),n("tr",[n("td",[n("code",[t._v("view_count")])]),n("td",[t._v("查看总数")]),n("td",[t._v("整数（int）")]),n("td",[t._v("文章查看数量排序")]),n("td",[n("code",[t._v("unsigned()")]),t._v(", "),n("code",[t._v("default(0)")])])]),n("tr",[n("td",[n("code",[t._v("last_reply_user_id")])]),n("td",[t._v("最后回复的用户 ID")]),n("td",[t._v("整数（int）")]),n("td",[t._v("数据关联")]),n("td",[n("code",[t._v("unsigned()")]),t._v(", "),n("code",[t._v("default(0)")])])]),n("tr",[n("td",[n("code",[t._v("order")])]),n("td",[t._v("可用来做排序使用")]),n("td",[t._v("整数（int）")]),n("td",[t._v("不需要")]),n("td",[n("code",[t._v("default(0)")])])]),n("tr",[n("td",[n("code",[t._v("excerpt")])]),n("td",[t._v("文章摘要，SEO 优化时使用")]),n("td",[t._v("文本（text）")]),n("td",[t._v("不需要")]),n("td",[t._v("无")])]),n("tr",[n("td",[n("code",[t._v("slug")])]),n("td",[t._v("SEO 友好的 URI")]),n("td",[t._v("字符串（String）")]),n("td",[t._v("不需要")]),n("td",[n("code",[t._v("nullable()")])])])])]),n("ul",[n("li",[n("code",[t._v("unsigned()")]),t._v(" —— 设置不需要标识符（unsigned）")]),n("li",[n("code",[t._v("default()")]),t._v(" —— 为字段添加默认值。")]),n("li",[n("code",[t._v("nullable()")]),t._v(" —— 可为空")])]),n("p",[t._v("以上字段，拼接为最终命令：")]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[t._v("$ php artisan make"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("scaffold Topic "),n("span",{attrs:{class:"token operator"}},[t._v("--")]),t._v("schema"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"title:string:index,body:text,user_id:integer:unsigned:index,category_id:integer:unsigned:index,reply_count:integer:unsigned:default(0),view_count:integer:unsigned:default(0),last_reply_user_id:integer:unsigned:default(0),order:integer:unsigned:default(0),excerpt:text,slug:string:nullable"')]),t._v("\n")])]),n("p",[t._v("执行结果：")]),n("p",[n("img",{attrs:{src:a(969),alt:"file"}})]),n("p",[t._v("命令 "),n("code",[t._v("make:scaffold")]),t._v(" 的 "),n("code",[t._v("--schema")]),t._v(" 选项中是以逗号分隔的字段名称和设置信息，字段分别如下，对于上面的字段表格：")]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[t._v("title"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("string"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("index\nbody"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("text\nuser_id"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("index\ncategory_id"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("index\nreply_count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nview_count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlast_reply_user_id"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\norder"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("integer"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("unsigned"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nexcerpt"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("text\nslug"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("string"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("nullable\n")])]),n("p",[t._v("接下来我们看下代码生成器为我们做了哪些事情：")]),n("ol",[n("li",[t._v("创建话题的数据库迁移文件 —— 2017_09_26_111713_create_topics_table.php；")]),n("li",[t._v("创建话题数据工厂文件 —— TopicFactory.php；")]),n("li",[t._v("创建话题数据填充文件 —— TopicsTableSeeder.php；")]),n("li",[t._v("创建模型基类文件 —— Model.php， 并创建话题数据模型；")]),n("li",[t._v("创建话题控制器 —— TopicsController.php；")]),n("li",[t._v("创建表单请求的基类文件 —— Request.php，并创建话题表单请求验证类；")]),n("li",[t._v("创建话题模型事件监控器 "),n("code",[t._v("TopicObserver")]),t._v(" 并在 "),n("code",[t._v("AppServiceProvider")]),t._v(" 中注册；")]),n("li",[t._v("创建授权策略基类文件 —— Policy.php，同时创建话题授权类，并在 "),n("code",[t._v("AuthServiceProvider")]),t._v(" 中注册；")]),n("li",[t._v("在 web.php 中更新路由，新增话题相关的资源路由；")]),n("li",[t._v("新建符合资源控制器要求的三个话题视图文件，并存放于 "),n("code",[t._v("resources/views/topics")]),t._v(" 目录中；")]),n("li",[t._v("执行了数据库迁移命令 "),n("code",[t._v("artisan migrate")]),t._v("；")]),n("li",[t._v("因此次操作新建了多个文件，最终执行 "),n("code",[t._v("composer dump-autoload")]),t._v(" 来生成 classmap。")])]),n("p",[t._v("我们将在后面开发涉及到时，再讲解各个新建文件的功能。可以确认的是，在本章结束时，你将清楚地知道以上所有新建文件的功能，并从中体验到代码生成器带来的便利。")]),n("h2",{attrs:{id:"开始测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开始测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 开始测试")]),n("p",[t._v("此时打开 http://larabbs.test/topics ，查看话题列表页面：")]),n("p",[n("img",{attrs:{src:a(968),alt:"file"}})]),n("p",[t._v("打开 http://larabbs.test/topics/create 会被跳转到登录页面，登录成功后会自动跳转到：")]),n("p",[n("img",{attrs:{src:a(967),alt:"file"}})]),n("h2",{attrs:{id:"git-版本控制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#git-版本控制","aria-hidden":"true"}},[t._v("#")]),t._v(" Git 版本控制")]),n("p",[t._v("下面把代码纳入到版本管理：")]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[t._v("$ git add "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("A\n$ git commit "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("m "),n("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"Generated topics"')]),t._v("\n")])])])}],e=a(0),_=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},n,!1,null,null,null);s.default=_.exports},967:function(t,s,a){t.exports=a.p+"assets/img/3.3_3.a9f75538.png"},968:function(t,s,a){t.exports=a.p+"assets/img/3.3_2.c27492f5.png"},969:function(t,s,a){t.exports=a.p+"assets/img/3.3_1.8e783413.png"}}]);