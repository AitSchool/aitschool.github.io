(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{1364:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"_1-6-postman"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-postman","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.6 PostMan")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("PostMan 是一款跨平台，方便我们调试 API 的工具，你可以在 "),s("a",{attrs:{href:"https://www.getpostman.com/",target:"_blank",rel:"noopener noreferrer"}},[this._v("PostMan官网")]),this._v(" 下载，或者使用 "),s("a",{attrs:{href:"https://pan.baidu.com/s/1dEMMD2L",target:"_blank",rel:"noopener noreferrer"}},[this._v("百度网盘下载")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(783),alt:"file"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("打开 PostMan 界面如上图所示，大体可以分为四个区域，左侧"),a("code",[t._v("接口集合")]),t._v("类似文件夹的功能，我们可以把我们的接口保存在这里，右侧上中下分别是"),a("code",[t._v("请求地址")]),t._v("，"),a("code",[t._v("请求参数")]),t._v("和"),a("code",[t._v("请求结果")]),t._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("随便找个接口调用一下，这个是国家气象局提供的 "),s("a",{attrs:{href:"http://www.weather.com.cn/data/sk/101010100.html",target:"_blank",rel:"noopener noreferrer"}},[this._v("天气预报接口")]),this._v("，将其填入『请求地址』处：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(782),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以在左侧的区域，保存接口，我们新建一个 "),s("code",[this._v("Larabbs")]),this._v(" 目录。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(781),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(780),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在左侧我们看到了新建的文件夹 Larabbs，然后保存接口。\n"),s("img",{attrs:{src:a(779),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以给接口起个名字，填写响应的描述。\n"),s("img",{attrs:{src:a(778),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(777),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-编写调试接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写调试接口","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 编写调试接口")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("已经安装好了 DingoApi，接下来写两个路由，尝试一下 PostMan。Laravel 5.5 已经为我们准备好了 api 的路由文件，"),s("code",[this._v("routes/api.php")]),this._v("。打开这个文件，可以看到 Laravel 为我们写好的例子。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token php language-php"}},[a("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Http"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Request")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('/*\n|--------------------------------------------------------------------------\n| API Routes\n|--------------------------------------------------------------------------\n|\n| Here is where you can register API routes for your application. These\n| routes are loaded by the RouteServiceProvider within a group which\n| is assigned the "api" middleware group. Enjoy building your API!\n|\n*/')]),t._v("\n\nRoute"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("middleware")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'auth:api'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'/user'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Request "),a("span",{attrs:{class:"token variable"}},[t._v("$request")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$request")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("user")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token php language-php"}},[a("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Http"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Request")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('/*\n|--------------------------------------------------------------------------\n| API Routes\n|--------------------------------------------------------------------------\n|\n| Here is where you can register API routes for your application. These\n| routes are loaded by the RouteServiceProvider within a group which\n| is assigned the "api" middleware group. Enjoy building your API!\n|\n*/')]),t._v("\n\n"),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("app")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'Dingo\\Api\\Routing\\Router'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("version")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'v1'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'version'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("response")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'this is version v1'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("version")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'v2'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token variable"}},[t._v("$api")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'version'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("response")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'this is version v2'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("路由需要使用 "),s("code",[this._v("Dingo\\Api\\Routing\\Router")]),this._v(" 注册，写法同 Laravel 的路由，大家应该比较熟悉。DingoApi 提供了 version 方法，用来进行版本控制，第一个参数是版本名称，version 中的就是不用版本的路由。我们在 v1 和 v2 两个版本中，都注册了 verison 路由，但是响应不同，现在通过 PostMan 来试试。\n还记得我们配置的是 "),s("code",[this._v("API_PREFIX=api")]),this._v("，所以需要 "),s("code",[this._v("http://larabbs.test/api")]),this._v(" 来访问。\n"),s("img",{attrs:{src:a(776),alt:"file"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("我们得到了 v1 版本的结果，"),a("code",[t._v("this is version v1")]),t._v("，因为配置了默认的版本是 v1 "),a("code",[t._v("API_VERSION=v1")]),t._v("。但是下面却多出来了一些 html，这其实是 Larabbs 安装的 "),a("code",[t._v("laravel-debugbar")]),t._v("，做接口相关的开发，不涉及网页，所以我们现在来关闭它。\n打开 config/debugbar.php，可以看到一行配置 "),a("code",[t._v("enabled")]),t._v("。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'enabled'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("env")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'APP_DEBUG'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("该配置控制 "),s("code",[this._v("debugbar")]),this._v(" 的开启和关闭，但是它现在是随着 "),s("code",[this._v("APP_DEBUG")]),this._v(" 的改变而改变的，我们可以把代码修改为")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'enabled'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("env")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'DEBUGBAR_ENABLE'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这样我们本地测试环境 "),s("code",[this._v("APP_DEBUG")]),this._v(" 依然可以是true，同时也可以关闭"),s("code",[this._v("laravel-debugbar")]),this._v("。默认 "),s("code",[this._v("laravel-debugbar")]),this._v(" 是关闭的，我们再次通过 PostMan 访问该接口。\n"),s("img",{attrs:{src:a(775),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("一切正常了，记得当我们调试网页，需要用到"),s("code",[this._v("laravel-debugbar")]),this._v("的时候，在 .env 中增加"),s("code",[this._v("DEBUGBAR_ENABLE=true")]),this._v(" 即可。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面我们增加"),s("code",[this._v("Accept: application/prs.larabbs.v2+json")]),this._v("来访问 v2 版本的 version。\n"),s("img",{attrs:{src:a(774),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("提示: 由于路由被 DingoApi 接管了，如果将来部署上线后你需要缓存路由，可以使用 "),s("code",[this._v("php artisan api:cache")]),this._v(" 代替 "),s("code",[this._v("php artisan route:cache")]),this._v(" 。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-postman-的环境变量功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-postman-的环境变量功能","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. PostMan 的环境变量功能")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("PostMan 为我们提供了环境变量的功能，通过切换不同的环境，可以使用不同的值，比如 host 我们就可以做成变量，这样当我们某一天切换了本地调试的域名，比如由 larabbs.app 切换为 larabbs.test 时，不用去每个接口中修改，只需要修改变量即可。\n"),s("img",{attrs:{src:a(773),alt:"file"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_4-代码版本控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-代码版本控制","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. 代码版本控制")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{attrs:{class:"token function"}},[this._v("git")]),this._v(" checkout routes/api.php\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("然后将"),s("code",[this._v("config/debugbar.php")]),this._v("提交：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{attrs:{class:"token function"}},[this._v("git")]),this._v(" add -A\n$ "),s("span",{attrs:{class:"token function"}},[this._v("git")]),this._v(" commit -m "),s("span",{attrs:{class:"token string"}},[this._v('"fix laravel-debugbar"')]),this._v("\n")])])}],e=a(0),r=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),a("p",[t._v("我们可以将已经调试好的接口保存下来，方便下次调试，PostMan 也为我们提供了导出导入接口的功能，方便分享接口给他人，当然 PostMan 也为付费用户提供了更多方便的功能，大家有需要的可以取官网了解，目前免费版的功能已经满足我们的需求。")]),t._m(12),t._m(13),t._m(14),a("p",[t._v("由于我们使用的是 DingoApi 的路由，所以将文件替换为如下内容")]),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),a("p",[t._v("比如上面，我们增加了一个环境变量 "),a("code",[t._v("host")]),t._v("，然后我们选择对应的环境，将域名替换为 "),a("code",[t._v(t._s(t.host))]),t._v("，PostMan url 中，使用双括号表示变量。同样能访问得到正确的结果。")]),t._m(27),a("p",[t._v("最后，我们将测试的路由代码恢复：")]),t._m(28),t._m(29),t._m(30)])},n,!1,null,null,null);s.default=r.exports},773:function(t,s,a){t.exports=a.p+"assets/img/1.6_11.4ac5030c.gif"},774:function(t,s,a){t.exports=a.p+"assets/img/1.6_10.2798cfc9.png"},775:function(t,s,a){t.exports=a.p+"assets/img/1.6_9.a41fe126.png"},776:function(t,s,a){t.exports=a.p+"assets/img/1.6_8.2ddcb11c.png"},777:function(t,s,a){t.exports=a.p+"assets/img/1.6_7.3bb4a23d.png"},778:function(t,s,a){t.exports=a.p+"assets/img/1.6_6.507265cb.png"},779:function(t,s,a){t.exports=a.p+"assets/img/1.6_5.481d47fe.png"},780:function(t,s,a){t.exports=a.p+"assets/img/1.6_4.f1c85199.png"},781:function(t,s,a){t.exports=a.p+"assets/img/1.6_3.d8b2bdc1.png"},782:function(t,s,a){t.exports=a.p+"assets/img/1.6_2.0fdc56ab.png"},783:function(t,s,a){t.exports=a.p+"assets/img/1.6_1.9c82ca47.png"}}]);