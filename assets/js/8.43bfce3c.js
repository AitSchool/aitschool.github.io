(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1705:function(t,s,a){"use strict";a.r(s);var n=a(0),p=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"package"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package","aria-hidden":"true"}},[t._v("#")]),t._v(" Package")]),a("p",[t._v("打包工具")]),a("p",[t._v("在项目开发中，一般都会在 src 开发环境目录开发，开发完毕后打包到 dist 生成使用目录。在开发环境中，我们可以根据我们代码的规范，使用各种预处理器来书写代码。在代码完毕之后，通过工具 转译、压缩、添加后缀到生产环境使用。")]),a("h3",{attrs:{id:"工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工具","aria-hidden":"true"}},[t._v("#")]),t._v(" 工具")]),a("p",[t._v("目前主流的打包工具有：")]),a("ul",[a("li",[a("a",{attrs:{href:"https://www.gulpjs.com.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gulp")])]),a("li",[a("a",{attrs:{href:"https://webpack.docschina.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack")])]),a("li",[a("a",{attrs:{href:"https://rollup.docschina.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollupjs")])])]),a("h3",{attrs:{id:"方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案","aria-hidden":"true"}},[t._v("#")]),t._v(" 方案")]),a("p",[t._v("打包方案选择用 gulp + webpack 。会有疑问为什么使用两者，而不是只使用gulp 或者 webpack ? 这里引用寸大 "),a("a",{attrs:{href:"https://www.zhihu.com/question/45536395",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎回答")]),t._v("。")]),a("blockquote",[a("p",[t._v("gulp 是 task runner，Webpack 是 module bundler。可以这么说， Webpack 和 gulp 本身都有 95% 的功能是不能被对方替代，或者直接说和对方不重叠的。 --寸志")])]),a("p",[a("strong",[t._v("gulp 最核心的功能：")])]),a("ol",[a("li",[t._v("任务定义和组织；")]),a("li",[t._v("基于文件 stream 的构建；")]),a("li",[t._v("插件体系；")])]),a("p",[t._v("gulp 本身对具体的构建任务可以没有任何的要求。但通常是文件流操作。可以这么说，gulp 适合于任何基于 JavaScript 构建的场合，无论是前端还是后端（Node.js）；甚至可以在 gulp 里直接调用 Webpack 。")]),a("p",[a("strong",[t._v("webpack 最核心的功能：")])]),a("ol",[a("li",[t._v("按照模块的依赖构建目标文件；")]),a("li",[t._v("loader 体系支持不同的模块；")]),a("li",[t._v("插件体系提供更多额外的功能；")])]),a("p",[t._v("把各种资源（js/ts/css/html/ejs/img/fonts等等）都看成 module；module 之间必须是互相依赖的，在 js 里 import 模板、图片、样式文件等等，样式文件通过  url() 和图片字体关联；这种依赖关系必须是 webpack 既定的或者是通过插件可以理解的关系。")]),a("p",[t._v("Webpack 的核心就是模块化地组织，模块化地依赖，然后模块化地打包。相对来上，场景局限在前端模块化打包上；虽然用 gulp + 插件的方式也能实现，但目前看 "),a("strong",[t._v("Webpack 在依赖的模块化构建上是无人能够替代的")]),t._v("。")]),a("p",[a("strong",[t._v("请问两者有哪些功能是重叠的？")])]),a("p",[t._v("基于模块依赖的构建这方面，虽然 gulp 也可以实现，但交给更专业的 Webpack 来做；甚至可以使用 "),a("a",{attrs:{href:"https://github.com/shama/webpack-stream",target:"_blank",rel:"noopener noreferrer"}},[t._v("shama/webpack-stream")]),t._v(" 来把 Webpack 封装成 gulp 任务；其他功能，例如文件压缩，Webpack 也有自己的 UglifyJsPlugin 插件，gulp 也有 gulp-uglify，通常答主会选择 gulp 来实现，因为 gulp 除此之外还有更多的比如 CSS 压缩，图片压缩等等可用；")]),a("p",[a("strong",[t._v("哪些功能是不能被对方替代的？")])]),a("p",[t._v("Webpack 之前，做模块化依赖构建的有 Browserify。可以使用 Browserify 的 gulp 插件 deepak1556/gulp-browserify 结合上 Browserify 的插件 substack/node-browserify 实现 Webpack 提供的基于模块依赖的构建。只是 Webpack 功能完善更强大，所以这方面的事情，交给 Webpack 搞。")]),a("p",[t._v("核心功能无法替代，gulp 任务定义和管理 Webpack 做不到，Webpack 基于模块的依赖构建 gulp 做不好。举几个例子：")]),a("p",[t._v("用 "),a("a",{attrs:{href:"https://www.npmjs.com/package/gulp-rev-all",target:"_blank",rel:"noopener noreferrer"}},[t._v("gulp-rev-all")]),t._v(" 来做所有资源引用的版本号替换：")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("gulp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("task")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'build'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" revAll "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("RevAll")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    prefix"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'http://xxxxx.clouddn.com'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    dontRenameFile"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v("'.html'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.xml'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.md'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.yml'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.ico'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    dontUpdateReference"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v("'.html'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.xml'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.md'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.yml'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.ico'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" gulp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("src")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'dist/**'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("pipe")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("revAll"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("revision")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("pipe")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gulp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("dest")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'rev'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])]),a("p",[t._v("我可以用 "),a("a",{attrs:{href:"https://www.npmjs.com/package/gulp-qiniu",target:"_blank",rel:"noopener noreferrer"}},[t._v("gulp-qiniu")]),t._v(" 来把静态文件直接发布到七牛的 CDN")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("gulp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("task")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'qiniu'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" gulp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("src")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v("'rev/css/**'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v("'rev/fonts/**'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v("'rev/js/**'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v("'rev/images/**'")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("base"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'rev'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("pipe")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("qiniu")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  accessKey"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" qiniuConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("accessKey"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  secretKey"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" qiniuConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("secretKey"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  bucket"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"qianduan"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("private")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  dir"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'/'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  concurrent"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("p",[a("strong",[t._v("在何种情况下用哪个工具更好？")]),t._v("\n除了前端模块化开发，模块之间充分依赖的项目，都不值得用 Webpack 去构建。反之，如果要用 Webpack，请确保模块化，模块之间充分依赖。除此之外的构建工作，都应该交给 gulp 继续完成。目前大点的项目，Webpack 和 gulp 都是同时存在的，只是各自负责擅长的那部分，比如 Webpack 将模块的、互相依赖的分散的代码打包成数个文件，然后再使用 gulp 任务去做压缩，加版本号，替换等等其他工作。")]),a("p",[t._v("在我们开发框架的时候，我们只涉及到JS的模块，而不会涉及到图片及及其相关模块，建议使用 rollup。")])])}],!1,null,null,null);s.default=p.exports}}]);