(window.webpackJsonp=window.webpackJsonp||[]).push([[304],{1393:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"_6-4-用户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-用户","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.4 用户")]),n("h2",{attrs:{id:"模型配置信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模型配置信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 模型配置信息")]),n("p",[t._v("Administrator 的运行机制是通过解析『模型配置信息』来生成后台，每一个模型配置文件对应一个数据模型，同时也对应一个页面。目前我们的项目里有 6 个数据模型，接下来我们将分别为他们定制模型配置信息。")]),n("h2",{attrs:{id:"配置信息与后台布局"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置信息与后台布局","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置信息与后台布局")]),n("p",[t._v("配置信息主要由三个布局选项，再加上其他如数据模型、权限控制、表单验证规则等选项构成。开始之前我们先讲解下三个布局在页面上的位置，以此来帮助我们更好地理解『模型配置信息』选项。")]),n("h3",{attrs:{id:"布局选项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#布局选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 布局选项")]),n("p",[t._v("三个布局选项分别是：")]),n("ul",[n("li",[t._v("1). 数据表格 —— 对应选项 "),n("code",[t._v("columns")]),t._v("，用来列表数据，支持分页和批量删除；")]),n("li",[t._v("2). 模型表单 —— 对应选项 "),n("code",[t._v("edit_fields")]),t._v("，用来新建和编辑模型数据；")]),n("li",[t._v("3). 数据过滤 —— 对应选项 "),n("code",[t._v("filters")]),t._v("，与数据表格实时响应的表单，用来筛选数据。")])]),n("p",[n("img",{attrs:{src:a(846),alt:"file"}})]),n("p",[n("img",{attrs:{src:a(845),alt:"file"}})]),n("h3",{attrs:{id:"必填选项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#必填选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 必填选项")]),n("p",[t._v("除了上面提到的三个布局选项，一个合格模型配置信息里，还必须包含以下选项：")]),n("ul",[n("li",[t._v("title —— 标题设置")]),n("li",[t._v("single —— 模型单数，用作新建按钮的命名如『新建 $single』")]),n("li",[t._v("model —— 数据模型，用作数据的 CRUD")])]),n("h2",{attrs:{id:"用户模型配置-users"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户模型配置-users","aria-hidden":"true"}},[t._v("#")]),t._v(" 用户模型配置 users")]),n("p",[t._v("接下来开始我们第一个数据模型的配置，请注意看代码注释：")]),n("p",[n("em",[t._v("config/administrator/users.php")])]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token php language-php"}},[n("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),n("span",{attrs:{class:"token package"}},[t._v("App"),n("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),n("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 页面标题")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v("   "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 模型单数，用作页面『新建 $single』")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'single'")]),t._v("  "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 数据模型，用作数据的 CRUD")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'model'")]),t._v("   "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" User"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 设置当前页面的访问权限，通过返回布尔值来控制权限。")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 返回 True 即通过权限验证，False 则无权访问并从 Menu 中隐藏")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'permission'")]),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Auth"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token function"}},[t._v("user")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token function"}},[t._v("can")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'manage_users'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 字段负责渲染『数据表格』，由无数的『列』组成，")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'columns'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 列的标示，这是一个最小化『列』信息配置的例子，读取的是模型里对应")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 的属性的值，如 $model->id")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'id'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'avatar'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 数据表格里列的名称，默认会使用『列标识』")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v("  "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'头像'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 默认情况下会直接输出数据，你也可以使用 output 选项来定制输出内容")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'output'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$avatar")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token variable"}},[t._v("$model")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("empty")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$avatar")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'N/A'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'<img src=\"'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token variable"}},[t._v("$avatar")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v('\'" width="40">\'')]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 是否允许排序")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'sortable'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v("    "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户名'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'sortable'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'output'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$name")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token variable"}},[t._v("$model")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'<a href=\"/users/'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token variable"}},[t._v("$model")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token property"}},[t._v("id")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'\" target=_blank>'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token variable"}},[t._v("$name")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'</a>'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'email'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'邮箱'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'operation'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v("  "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'管理'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'sortable'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 『模型表单』设置项")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'edit_fields'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户名'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'email'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'邮箱'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'password'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'密码'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 表单使用 input 类型 password")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'type'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'password'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'avatar'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户头像'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 设置表单条目的类型，默认的 type 是 input")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'type'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'image'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 图片上传必须设置图片存放路径")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'location'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("public_path")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'/uploads/images/avatars/'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'roles'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v("      "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户角色'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 指定数据的类型为关联模型")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'type'")]),t._v("       "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'relationship'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 关联模型的字段，用来做关联显示")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'name_field'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 『数据过滤』设置")]),t._v("\n    "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'filters'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'id'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 过滤表单条目显示名称")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户 ID'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'用户名'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'email'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'title'")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'邮箱'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("这时候打开浏览器访问 http://larabbs.test/admin/users ，请确保使用 ID 为 1 的用户登录访问：")]),n("p",[n("img",{attrs:{src:a(844),alt:"file"}})]),n("h2",{attrs:{id:"_1-测试数据筛选"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-测试数据筛选","aria-hidden":"true"}},[t._v("#")]),t._v(" 1). 测试数据筛选")]),n("p",[t._v("尝试一下实时响应的数据筛选：")]),n("p",[n("img",{attrs:{src:a(843),alt:"file"}})]),n("h2",{attrs:{id:"_2-测试模型编辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-测试模型编辑","aria-hidden":"true"}},[t._v("#")]),t._v(" 2). 测试模型编辑")]),n("p",[t._v("测试模型编辑功能：")]),n("p",[n("img",{attrs:{src:a(842),alt:"file"}})]),n("h2",{attrs:{id:"_3-测试删除功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-测试删除功能","aria-hidden":"true"}},[t._v("#")]),t._v(" 3). 测试删除功能")]),n("p",[n("img",{attrs:{src:a(841),alt:"file"}})]),n("h2",{attrs:{id:"_4-修改密码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-修改密码","aria-hidden":"true"}},[t._v("#")]),t._v(" 4). 修改密码")]),n("p",[t._v("为了方便测试，我们复制邮箱来作为第 9 号用户的密码：")]),n("p",[n("img",{attrs:{src:a(840),alt:"file"}})]),n("p",[t._v("返回主页，退出登录，然后重新进入登录页面，我们使用 9 号用户进行登录，账号和密码都是邮箱：")]),n("p",[n("img",{attrs:{src:a(839),alt:"file"}})]),n("p",[t._v("密码错误。")]),n("p",[t._v("我们需要先定位问题。可以先看看数据库 "),n("code",[t._v("users")]),t._v(" 表里的数据，瞧一瞧我们修改后的最终数据：")]),n("p",[n("img",{attrs:{src:a(838),alt:"file"}})]),n("p",[t._v("Laravel 的登录机制是使用了 "),n("a",{attrs:{href:"http://php.net/manual/zh/function.password-verify.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("password_verify")]),t._v(" 函数进行匹配验证，此函数接受两个参数 $password 和 $hash。在 Laravel 中，默认的登录功能这两个参数的值一般为：")]),n("ul",[n("li",[t._v("$password —— 是登录表单提交的明文密码；")]),n("li",[t._v("$hash —— 是哈希加密以后的数据，存储在数据表 "),n("code",[t._v("users")]),t._v(" 表里的 "),n("code",[t._v("password")]),t._v(" 字段。")])]),n("p",[t._v("所以导致我们无法登录的原因是存入了未加密的密码。解决方法是在存入数据库之前对数据做下加密即可。")]),n("p",[t._v("Administrator 并未提供给我们修改用户提交数据的方法，不过这种针对模型属性的操作，Eloquent 已经为我们提供了非常便捷的方法 —— "),n("a",{attrs:{href:"https://d.laravel-china.org/docs/5.5/eloquent-mutators",target:"_blank",rel:"noopener noreferrer"}},[t._v("Eloquent 修改器")]),t._v(" 。")]),n("p",[t._v("在 Eloquent 模型实例中获取或设置某些属性值的时候，访问器和修改器允许你对 Eloquent 属性值进行格式化。有两种方法可以修改 Eloquent 模型属性的值，一种是『访问器』，另一种是『修改器』。")]),n("p",[t._v("访问器和修改器最大的区别是『发生修改的时机』，访问器是 "),n("strong",[t._v("访问属性时")]),t._v(" 修改，修改器是在 "),n("strong",[t._v("写入数据库前")]),t._v(" 修改。修改器是数据持久化，访问器是临时修改。访问器的使用场景是当数据因为特殊原因存在不一致性时，可以使用访问器进行矫正处理。在我们的密码加密的场景里，我们会使用修改器在密码即将入库前，对其进行加密。")]),n("p",[t._v("我们须在模型上定义一个 "),n("code",[t._v("setPasswordAttribute")]),t._v(" 方法，注意命名规范是 "),n("code",[t._v("set{属性的驼峰式命名}Attribute")]),t._v("，当我们给属性赋值时，如 "),n("code",[t._v("$user->password = 'password'")]),t._v("，该修改器将被自动调用：")]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("setPasswordAttribute")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token variable"}},[t._v("$this")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token property"}},[t._v("attributes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'password'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("bcrypt")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("p",[t._v("需要注意的是，我们还需考虑项目中是否其他地方也会修改到 "),n("code",[t._v("password")]),t._v(" 字段？答案是有的，Laravel 自带的用户登录注册功能里，也有密码重置功能，我们来阅读下其源代码。")]),n("p",[t._v("ResetPasswordController 将重设密码的逻辑写在 "),n("code",[t._v("ResetsPasswords")]),t._v(" trait 里，打开这个文件，定位到密码更改并入库发生的方法 "),n("code",[t._v("resetPassword")]),t._v("：")]),n("p",[n("em",[t._v("vendor/laravel/framework/src/Illuminate/Foundation/Auth/ResetsPasswords.php")])]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("resetPassword")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$user")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token variable"}},[t._v("$password")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token variable"}},[t._v("$user")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token property"}},[t._v("password")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Hash"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token function"}},[t._v("make")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$password")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("p",[t._v("可以看到密码是经过哈希以后才赋值的，所以当我们在修改器中接收到数据时，应该会加密过的和未加密的数据。我们对这两种情况做区分对待：")]),n("p",[n("em",[t._v("app/Models/User.php")])]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token php language-php"}},[n("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Authenticatable")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("setPasswordAttribute")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 如果值的长度等于 60，即认为是已经做过加密的情况")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token function"}},[t._v("strlen")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("60")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 不等于 60，做密码加密处理")]),t._v("\n            "),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("bcrypt")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{attrs:{class:"token variable"}},[t._v("$this")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token property"}},[t._v("attributes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'password'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token variable"}},[t._v("$value")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("现在按照上面的测试步骤再次尝试，即可顺利登录 9 号用户：")]),n("p",[n("img",{attrs:{src:a(837),alt:"file"}})]),n("h2",{attrs:{id:"_5-修改用户头像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改用户头像","aria-hidden":"true"}},[t._v("#")]),t._v(" 5). 修改用户头像")]),n("p",[t._v("使用 1 号用户 Summer 登录后台，并尝试对 9 号用户进行头像修改：")]),n("p",[n("img",{attrs:{src:a(836),alt:"file"}})]),n("p",[t._v("会发现修改完成后的图片无法显示。还是使用老方法来调试，先看下数据库到底存了什么数据：")]),n("p",[n("img",{attrs:{src:a(835),alt:"file"}})]),n("p",[t._v("原来是因为链接不合法，只是一个文件名，当然无法显示图片。接下来我们将同样使用修改器来修复此问题，为即将入库的数据拼接完整的 URL 。同时，我们也需要考虑到其他地方对 "),n("code",[t._v("avatar")]),t._v(" 的赋值，用户修改资料时，我们为 "),n("code",[t._v("avatar")]),t._v(" 的赋值就是全路径，因此同样的我们需要考虑两种状况：")]),n("p",[n("em",[t._v("app/Models/User.php")])]),n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token php language-php"}},[n("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Authenticatable")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("setAvatarAttribute")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$path")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 如果不是 `http` 子串开头，那就是从后台上传的，需要补全 URL")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("starts_with")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token variable"}},[t._v("$path")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'http'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 拼接完整的 URL")]),t._v("\n            "),n("span",{attrs:{class:"token variable"}},[t._v("$path")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("config")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'app.url'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"/uploads/images/avatars/'),n("span",{attrs:{class:"token interpolation"}},[n("span",{attrs:{class:"token variable"}},[t._v("$path")])]),t._v('"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{attrs:{class:"token variable"}},[t._v("$this")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token property"}},[t._v("attributes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'avatar'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token variable"}},[t._v("$path")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("再次尝试，即可成功上传图片：")]),n("p",[n("img",{attrs:{src:a(834),alt:"file"}})]),n("h2",{attrs:{id:"git-版本控制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#git-版本控制","aria-hidden":"true"}},[t._v("#")]),t._v(" Git 版本控制")]),n("p",[t._v("将修改添加到 Git 中：")]),n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("$ "),n("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" add -A\n$ "),n("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),n("span",{attrs:{class:"token string"}},[t._v('"Admin can manage users"')]),t._v("\n")])])])}],r=a(0),o=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},n,!1,null,null,null);s.default=o.exports},834:function(t,s,a){t.exports=a.p+"assets/img/6.4_13.a16ffe9a.gif"},835:function(t,s,a){t.exports=a.p+"assets/img/6.4_12.f31e9aaa.png"},836:function(t,s,a){t.exports=a.p+"assets/img/6.4_11.46bc90a9.gif"},837:function(t,s,a){t.exports=a.p+"assets/img/6.4_10.31b22134.png"},838:function(t,s,a){t.exports=a.p+"assets/img/6.4_9.6597e42c.png"},839:function(t,s,a){t.exports=a.p+"assets/img/6.4_8.08b6e112.gif"},840:function(t,s,a){t.exports=a.p+"assets/img/6.4_7.7e1e2be3.gif"},841:function(t,s,a){t.exports=a.p+"assets/img/6.4_6.916f6c6d.gif"},842:function(t,s,a){t.exports=a.p+"assets/img/6.4_5.ff8888c4.gif"},843:function(t,s,a){t.exports=a.p+"assets/img/6.4_4.e747c5e3.gif"},844:function(t,s,a){t.exports=a.p+"assets/img/6.4_3.894ba4f1.png"},845:function(t,s,a){t.exports=a.p+"assets/img/6.4_2.a5669b09.png"},846:function(t,s,a){t.exports=a.p+"assets/img/6.4_1.0ef5452f.png"}}]);